<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AgriChain - Finance Report</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/i18next@23.4.7/i18next.min.js"></script>
<script src="https://unpkg.com/i18next-browser-languagedetector@7.0.1/i18nextBrowserLanguageDetector.min.js"></script>

<style>
* { margin:0; padding:0; box-sizing:border-box; font-family:'Poppins', sans-serif; }
body { background:#f4fdf4; color:#333; line-height:1.6; display:flex; flex-direction:column; min-height:100vh; }

/* Header */
header{
  background: rgba(25,105,44,0.95);
  padding:15px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:white;
  flex-wrap:wrap;
}
header img { height:50px; cursor:pointer; border-radius:12px; transition: transform 0.3s; }
header img:hover { transform: scale(1.1); }
header h1 { margin-left:10px; color:#19692c; font-size:1.8em; }
nav { display:flex; gap:20px; flex-wrap:wrap; justify-content:center; }
nav a { text-decoration:none; color:#f3f7f4; font-weight:600; transition:0.3s; }
nav a:hover { color:#ffeaa7; transform:scale(1.1);}
.language-toggle { display:flex; gap:10px; margin-top:10px; }
.language-toggle button { padding:6px 12px; border:none; cursor:pointer; border-radius:5px; background:#19692c; color:white; font-size:14px; }
.language-toggle button:hover { background:#0f4d23; }

/* Report */
.report { max-width:1000px; margin:40px auto; padding:30px; background:rgba(255,255,255,0.9); border-radius:12px; box-shadow:0 6px 15px rgba(0,0,0,0.1); text-align:center; }
.report h2 { font-size:2.2em; color:#19692c; margin-bottom:10px; }
.report p { font-size:1.1em; color:#444; margin-bottom:25px; }

/* Chart */
#financeChartContainer { width:90%; max-width:800px; margin:0 auto 40px; }
canvas { background:rgba(255,255,255,0.9); border-radius:10px; box-shadow:0 5px 15px rgba(0,0,0,0.2); padding:15px; }

/* Cards */
.report-details { display:flex; flex-wrap:wrap; justify-content:center; gap:25px; margin-top:20px; }
.detail-card { background:white; flex:1 1 280px; padding:25px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); transition:0.3s; }
.detail-card:hover { transform:translateY(-5px); box-shadow:0 8px 15px rgba(0,0,0,0.2); }
.detail-card h3 { color:#19692c; margin-bottom:10px; }
.detail-card p { color:#555; }

/* Back Button */
.back-btn { margin-top:30px; }
.back-btn a { display:inline-block; padding:10px 20px; border-radius:8px; background:#19692c; color:white; text-decoration:none; font-weight:bold; transition:0.3s; }
.back-btn a:hover { background:#0f4d23; transform:scale(1.05); }

/* Footer */
footer { background:#19692c; color:white; padding:40px 20px 20px 20px; border-radius:10px 10px 0 0; margin-top:auto; }
.footer-container { display:flex; flex-wrap:wrap; max-width:1200px; margin:0 auto; justify-content:space-between; gap:20px; }
.footer-brand, .footer-links, .footer-social { flex:1 1 250px; }
.footer-brand h2 { color:#a8d5a2; margin-bottom:10px; }
.footer-links h4, .footer-social h4 { color:#a8d5a2; margin-bottom:10px; }
.footer-links ul { list-style:none; padding-left:0; }
.footer-links li { margin-bottom:8px; }
.footer-links a, .footer-social a { color:white; text-decoration:none; font-weight:bold; transition:0.3s; }
.footer-links a:hover, .footer-social a:hover { color:#a8d5a2; }
.footer-bottom { text-align:center; margin-top:20px; border-top:1px solid rgba(255,255,255,0.3); padding-top:10px; }

@media(max-width:768px){
  header h1 { font-size:1.5em; }
  .report-details { flex-direction:column; align-items:center; }
  .footer-container { flex-direction:column; text-align:center; }
}
</style>
</head>

<body>
<header>
    <div class="logo-container" style="display:flex; align-items:center;">
        <img src="../images/logo.png" alt="AgriChain Logo">
        <h1>AgriChain</h1>
    </div>
    <nav>
        <a href="../index.html" data-i18n="nav-home">Home</a>
        <a href="../All/about.html" data-i18n="nav-about">About</a>
        <a href="../Dashboard/farmer/farmer-dashboard.html" data-i18n="nav-farmer">Farmer</a>
        <a href="#" data-i18n="nav-buyer">Buyer</a>
        <a href="#" data-i18n="nav-admin">Admin</a>
        <a href="#" data-i18n="nav-transporter">Transporter</a>
        <a href="#" data-i18n="nav-insurance">Insurance</a>
    </nav>
    <div class="language-toggle">
        <button onclick="changeLng('en')">English</button>
        <button onclick="changeLng('ta')">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
    </div>
</header>

<section class="report">
    <h2 data-i18n="finance-title">üí∞ Finance Report</h2>
    <p data-i18n="finance-text">Track income, expenses, and profitability of your farming business.</p>

    <!-- CHART CONTAINER -->
    <div id="financeChartContainer">
        <canvas id="financeChart"></canvas>
    </div>

    <!-- Summary Cards -->
    <div class="report-details" id="finance-summary">
        <div class="detail-card">
            <h3 data-i18n="income-title">üìà Income</h3>
            <p id="income-value">Loading...</p>
        </div>
        <div class="detail-card">
            <h3 data-i18n="expense-title">üìâ Expenses</h3>
            <p id="expense-value">Loading...</p>
        </div>
        <div class="detail-card">
            <h3 data-i18n="profit-title">üíπ Profit</h3>
            <p id="profit-value">Loading...</p>
        </div>
    </div>

    <div class="back-btn">
      <a href="../All/reports.html"><i class="fas fa-arrow-left"></i> <span data-i18n="back-btn">Back to Reports</span></a>
    </div>
</section>

<footer>
  <div class="footer-container">
    <div class="footer-brand">
      <h2 data-i18n="footer-brand-title">AgriChain</h2>
      <p data-i18n="footer-text">Empowering farmers, ensuring transparency, and connecting directly with buyers through blockchain technology.</p>
    </div>
    <div class="footer-links">
      <h4>Quick Links</h4>
      <ul>
        <li><a href="../index.html" data-i18n="footer-home">Home</a></li>
        <li><a href="../All/about.html" data-i18n="footer-about">About</a></li>
        <li><a href="../All/contact.html" data-i18n="footer-contact">Contact</a></li>
      </ul>
    </div>
    <div class="footer-social">
      <h4>Follow Us</h4>
      <a href="https://facebook.com"><i class="fab fa-facebook-f"></i> Facebook</a>
      <a href="https://wa.me/+919541954142"><i class="fab fa-whatsapp"></i> WhatsApp</a>
      <a href="https://twitter.com"><i class="fab fa-twitter"></i> Twitter</a>
    </div>
  </div>
  <div class="footer-bottom">
    <p data-i18n="footer-bottom-text">¬© 2025 AgriChain. All Rights Reserved.</p>
  </div>
</footer>

<script>
i18next.use(i18nextBrowserLanguageDetector).init({
  fallbackLng:'en',
  resources:{
    en:{translation:{
      "nav-home":"Home","nav-about":"About","nav-farmer":"Farmer","nav-buyer":"Buyer","nav-admin":"Admin","nav-transporter":"Transporter","nav-insurance":"Insurance",
      "finance-title":"üí∞ Finance Report","finance-text":"Track income, expenses, and profitability of your farming business.",
      "income-title":"üìà Income","expense-title":"üìâ Expenses","profit-title":"üíπ Profit","back-btn":"Back to Reports",
      "footer-brand-title":"AgriChain","footer-text":"Empowering farmers, ensuring transparency, and connecting directly with buyers through blockchain technology.",
      "footer-home":"Home","footer-about":"About","footer-contact":"Contact","footer-bottom-text":"¬© 2025 AgriChain. All Rights Reserved."
    }},
    ta:{translation:{
      "nav-home":"‡ÆÆ‡ØÅ‡Æï‡Æ™‡Øç‡Æ™‡ØÅ","nav-about":"‡Æ™‡Æ±‡Øç‡Æ±‡Æø","nav-farmer":"‡Æµ‡Æø‡Æµ‡Æö‡Ææ‡ÆØ‡Æø","nav-buyer":"‡Æµ‡Ææ‡Æô‡Øç‡Æï‡ØÅ‡Æ™‡Æµ‡Æ∞‡Øç","nav-admin":"‡Æ®‡Æø‡Æ∞‡Øç‡Æµ‡Ææ‡Æï‡Æø","nav-transporter":"‡Æ™‡Øã‡Æï‡Øç‡Æï‡ØÅ‡Æµ‡Æ∞‡Æ§‡Øç‡Æ§‡ØÅ","nav-insurance":"‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡ØÄ‡Æü‡ØÅ",
      "finance-title":"üí∞ ‡Æ®‡Æø‡Æ§‡Æø ‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà","finance-text":"‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æø‡Æµ‡Æö‡Ææ‡ÆØ‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡Æµ‡Æ∞‡ØÅ‡ÆÆ‡Ææ‡Æ©‡ÆÆ‡Øç, ‡Æö‡ØÜ‡Æ≤‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æá‡Æ≤‡Ææ‡Æ™‡Æ§‡Øç‡Æ§‡Øà ‡Æï‡Æ£‡Øç‡Æï‡Ææ‡Æ£‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.",
      "income-title":"üìà ‡Æµ‡Æ∞‡ØÅ‡Æµ‡Ææ‡ÆØ‡Øç","expense-title":"üìâ ‡Æö‡ØÜ‡Æ≤‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç","profit-title":"üíπ ‡Æá‡Æ≤‡Ææ‡Æ™‡ÆÆ‡Øç","back-btn":"‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æ§‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡Æµ‡ØÅ‡ÆÆ‡Øç",
      "footer-brand-title":"‡ÆÖ‡Æï‡Øç‡Æ∞‡Æø‡Æö‡Øç‡Æö‡ØÜ‡ÆØ‡Æø‡Æ©‡Øç","footer-text":"‡Æµ‡Æø‡Æµ‡Æö‡Ææ‡ÆØ‡Æø‡Æï‡Æ≥‡Øà ‡Æµ‡Æ≤‡ØÅ‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æø, ‡Æ§‡ØÜ‡Æ≥‡Æø‡Æµ‡ØÅ‡Æ§‡Øç‡Æ§‡Æ©‡Øç‡ÆÆ‡Øà‡ÆØ‡Øà ‡Æâ‡Æ±‡ØÅ‡Æ§‡Æø ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡ØÅ, ‡Æµ‡Ææ‡Æü‡Æø‡Æï‡Øç‡Æï‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç‡Æï‡Æ≥‡ØÅ‡Æü‡Æ©‡Øç ‡Æ®‡Øá‡Æ∞‡Æü‡Æø‡ÆØ‡Ææ‡Æï ‡Æá‡Æ£‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ.",
      "footer-home":"‡ÆÆ‡ØÅ‡Æï‡Æ™‡Øç‡Æ™‡ØÅ","footer-about":"‡Æ™‡Æ±‡Øç‡Æ±‡Æø","footer-contact":"‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ™‡ØÅ","footer-bottom-text":"¬© 2025 ‡ÆÖ‡Æï‡Øç‡Æ∞‡Æø‡Æö‡Øç‡Æö‡ØÜ‡ÆØ‡Æø‡Æ©‡Øç. ‡Æé‡Æ≤‡Øç‡Æ≤‡Ææ ‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡Æï‡Æ≥‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æµ‡Øà."
    }}
  }
}, updateContent);

function updateContent(){
  document.querySelectorAll('[data-i18n]').forEach(el=>{
    el.innerHTML=i18next.t(el.getAttribute('data-i18n'));
  });
}

function changeLng(lang){ i18next.changeLanguage(lang, updateContent); }

/* REST API Integration */
async function loadFinanceData(){
  try {
    const res = await fetch("http://localhost/agrichain/api/get_finance_report.php");
    const data = await res.json();

    // Example expected response:
    // { "income":120000, "expenses":65000, "profit":55000 }

    document.getElementById("income-value").innerHTML = Total Income: <strong>‚Çπ${data.income}</strong>;
    document.getElementById("expense-value").innerHTML = Total Expenses: <strong>‚Çπ${data.expenses}</strong>;
    document.getElementById("profit-value").innerHTML = Profit: <strong>‚Çπ${data.profit}</strong>;

    const ctx = document.getElementById("financeChart").getContext("2d");
    new Chart(ctx, {
      type: "bar",
      data: {
        labels: ["Income", "Expenses", "Profit"],
        datasets: [{
          label: "Amount (‚Çπ)",
          data: [data.income, data.expenses, data.profit],
          backgroundColor: ["#2ecc71","#e74c3c","#3498db"],
          borderRadius:10
        }]
      },
      options: {
        responsive:true,
        plugins:{
          title:{display:true, text:"Financial Overview", font:{size:20}},
          legend:{display:false}
        },
        scales:{
          y:{beginAtZero:true, title:{display:true, text:"Amount (‚Çπ)"}}
        }
      }
    });
  } catch(err){
    console.error(err);
    document.getElementById("finance-summary").innerHTML = "<p>‚ö† Failed to load finance data.</p>";
  }
}

// Load data on page open
window.onload = loadFinanceData;
</script>
</body>
</html>
