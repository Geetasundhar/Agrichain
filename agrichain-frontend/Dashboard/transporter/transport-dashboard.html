<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title data-i18n="title">Transport Dashboard - AgriChain</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;transition:.3s;}
body{background:#f9f9f9;min-height:100vh;}

body::before{
 content:"";position:fixed;inset:0;
 background:url('../../images/trans-dashboard.png') center/cover no-repeat;
 opacity:.13;z-index:-1;filter:blur(1px);
}

/* ✅ Navbar Styling */
header.navbar{
 background:rgba(25,105,44,.95);
 padding:15px 25px;
 color:#fff;
 display:flex;
 justify-content:space-between;
 align-items:center;
 flex-wrap:wrap;
 border-bottom:3px solid #a8d5a2;
 position:sticky;top:0;z-index:1000;
}

.logo-area{
 display:flex;align-items:center;gap:12px;
}

.logo{
 height:45px;width:45px;border-radius:50%;
 object-fit:cover;box-shadow:0 2px 5px rgba(0,0,0,0.3);
}

header h1{color:#d4edda;font-size:1.8em;font-weight:700;text-shadow:0 2px 4px rgba(0,0,0,.3);}

.nav-links{
 display:flex;gap:18px;flex-wrap:wrap;
}

.nav-links a{
 color:#fff;text-decoration:none;font-weight:600;padding:6px 10px;
 border-radius:6px;position:relative;
}

.nav-links a:hover, .nav-links a.active{
 color:#ffeaa7;background:rgba(255,255,255,0.15);
 transform:translateY(-2px);
}

/* ✅ Language Buttons */
.language-toggle{display:flex;gap:10px;}
.language-toggle button{
 background:#0f4d23;color:#fff;border:none;padding:6px 12px;
 border-radius:8px;cursor:pointer;font-size:.9em;
}
.language-toggle button:hover{background:#083317;}

/* ✅ Mobile Menu */
.mobile-menu{
 display:none;font-size:1.7em;cursor:pointer;margin-left:10px;
}

@media(max-width:820px){
 .nav-links{
   width:100%;display:none;flex-direction:column;margin-top:10px;
   background:#19692c;padding:10px 15px;border-radius:8px;
 }
 .nav-links.show{display:flex;}
 .mobile-menu{display:block;}
}

/* ✅ Dashboard Section */
section{
 max-width:1100px;margin:40px auto;
 background:#fff;padding:30px 25px;border-radius:15px;
 box-shadow:0 4px 15px rgba(0,0,0,.1);
}
section h2{color:#19692c;text-align:center;font-size:2em;margin-bottom:8px;}
section p{text-align:center;margin-bottom:15px;color:#555;}

table{width:100%;border-collapse:collapse;margin-top:15px;}
th,td{padding:12px;text-align:center;border-bottom:1px solid #ddd;}
th{background:#19692c;color:#fff;}
tr:hover{background:#f1f8f3;}

.status{padding:5px 10px;border-radius:6px;color:#fff;font-weight:bold;}
.pending{background:#f39c12;}
.transit{background:#3498db;}
.delivered{background:#2ecc71;}

button{
 background:#19692c;color:#fff;border:none;padding:7px 14px;
 border-radius:8px;cursor:pointer;font-size:.9em;
}
button:hover{background:#0f4d23;transform:scale(1.05);}

/* ✅ Footer */
footer{
 background:#19692c;color:#fff;text-align:center;
 padding:18px;font-size:.9em;margin-top:40px;
 border-radius:10px 10px 0 0;
}
</style>
</head>

<body>

<header class="navbar">
 <div class="logo-area">
  <img src="../../images/logo.png" class="logo" alt="Logo">
 </div>

 <nav class="nav-links">
    <a href="../../index.html" data-i18n="nav.home">Home</a>
    <a href="../../All/about.html" data-i18n="nav.about">About</a>
    <a href="../../instruction/farmerinstruction.html" data-i18n="nav.farmer">Farmer</a>
    <a href="../../instruction/buyerinstruction.html" data-i18n="nav.buyer">Buyer</a>
    <a href="../../instruction/admininstruction.html" data-i18n="nav.admin">Admin</a>
    <a href="../../instruction/trnsportinstruction.html"  data-i18n="nav.transporter">Transporter</a>
    <a href="../../instruction/insuranceinstruction.html" data-i18n="nav.insurance">Insurance</a>
 </nav>

 <div class="language-toggle">
  <button onclick="changeLang('en')">English</button>
  <button onclick="changeLang('ta')">தமிழ்</button>
 </div>

 <div class="mobile-menu" onclick="toggleMenu()">
   <i class="fa fa-bars"></i>
 </div>
</header>

<section>
 <h2 data-i18n="section.heading">Transport Dashboard</h2>
 <p data-i18n="section.desc">Track all ongoing and completed deliveries below.</p>

 <table>
  <thead>
   <tr>
    <th data-i18n="table.id">Order ID</th>
    <th data-i18n="table.crop">Crop</th>
    <th data-i18n="table.pickup">Pickup</th>
    <th data-i18n="table.drop">Drop</th>
    <th data-i18n="table.charge">Charge</th>
    <th data-i18n="table.status">Status</th>
    <th data-i18n="table.action">Action</th>
   </tr>
  </thead>
  <tbody id="transportData"></tbody>
 </table>
</section>

<footer>
 <p data-i18n="footer.text">© 2025 AgriChain. Empowering Farmers, Connecting Buyers.</p>
</footer>

<script src="https://unpkg.com/i18next@23.7.6/dist/umd/i18next.min.js"></script>

<script>
/* ✅ LANGUAGE DATA */
const resources = {
 en:{translation:{
  title:"Transport Dashboard - AgriChain",
  brand:"AgriChain",
  nav:{home:"Home",about:"About",farmer:"Farmer",buyer:"Buyer",admin:"Admin",transporter:"Transporter",insurance:"Insurance"},
  section:{heading:"Transport Dashboard",desc:"Track all ongoing and completed deliveries below."},
  table:{id:"Order ID",crop:"Crop",pickup:"Pickup",drop:"Drop",charge:"Charge",status:"Status",action:"Action"},
  footer:{text:"© 2025 AgriChain. Empowering Farmers, Connecting Buyers."}
 }},
 ta:{translation:{
  title:"போக்குவரத்து பலகை - அக்ரிச்செயின்",
  brand:"அக்ரிச்செயின்",
  nav:{home:"முகப்பு",about:"பற்றி",farmer:"விவசாயி",buyer:"வாங்குபவர்",admin:"நிர்வாகி",transporter:"போக்குவரத்து",insurance:"காப்பீடு"},
  section:{heading:"போக்குவரத்து பலகை",desc:"நடைபெறும் மற்றும் முடிந்த விநியோகங்களை கண்காணிக்கவும்."},
  table:{id:"ஆர்டர் ஐடி",crop:"பயிர்",pickup:"எடுத்த இடம்",drop:"விநியோக இடம்",charge:"கட்டணம்",status:"நிலை",action:"செயல்"},
  footer:{text:"© 2025 அக்ரிச்செயின். விவசாயிகளை வலுப்படுத்தி வாங்குபவர்களை இணைக்கும் தளம்."}
 }}
};

/* ✅ Init i18n */
i18next.init({lng:"en",resources},updateContent);
function updateContent(){
 document.querySelectorAll("[data-i18n]").forEach(el=>{
  el.innerHTML=i18next.t(el.getAttribute("data-i18n"));
  if(el.tagName==="TITLE") el.textContent=i18next.t(el.getAttribute("data-i18n"));
 });
}
function changeLang(lang){i18next.changeLanguage(lang,updateContent);}

/* ✅ Load data from backend */
async function loadTransports() {
 try {
   const response = await fetch("/api/transporter/orders");
   const data = await response.json();

   const table = document.getElementById("transportData");

   if (!data.length) {
     table.innerHTML = `<tr><td colspan="7">No transport requests found</td></tr>`;
     return;
   }

   table.innerHTML = data.map(t => `
    <tr>
      <td>${t.order_id}</td>
      <td>${t.crop_name}</td>
      <td>${t.pickup_location}</td>
      <td>${t.drop_location}</td>
      <td>₹${t.charge}</td>
      <td><span class="status ${t.status.replace(" ", "").toLowerCase()}">${t.status}</span></td>
      <td><button onclick="track('${t.order_id}')"><i class='fa fa-truck'></i> Track</button></td>
    </tr>`).join("");
 } catch (err) {
   console.error(err);
   document.getElementById("transportData").innerHTML =
   `<tr><td colspan="7" style="color:red;">Error fetching data</td></tr>`;
 }
}

function track(id){ alert("Tracking Order: " + id); }
loadTransports();

/* ✅ Mobile Menu Toggle */
function toggleMenu(){
 document.querySelector(".nav-links").classList.toggle("show");
}
</script>

</body>
</html>
