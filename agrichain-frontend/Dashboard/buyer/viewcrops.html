<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title data-i18n="title">View Crops - AgriChain</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;}
body{background:#f9f9f9;color:#333;}

/* ===== Header ===== */
header{
  background:rgba(25,105,44,0.95);
  padding:15px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:white;
  flex-wrap:wrap;
}
header img{height:80px;border-radius:15px;box-shadow:0 6px 12px rgba(0,0,0,0.3);transition:transform 0.4s,box-shadow 0.4s;cursor:pointer;}
header img:hover{transform:scale(1.2) rotate(-5deg);box-shadow:0 10px 20px rgba(0,0,0,0.5);}
nav{display:flex;gap:20px;flex-wrap:wrap;justify-content:center;}
nav a{text-decoration:none;color:#f3f7f4;font-weight:600;transition:0.3s;font-size:1.05em;}
nav a:hover,nav a.active{color:#ffeaa7;transform:scale(1.1);}
.language-toggle{display:flex;gap:10px;margin-top:10px;}
.language-toggle button{padding:6px 12px;border:none;cursor:pointer;border-radius:5px;background:#19692c;color:white;font-size:14px;}
.language-toggle button:hover{background:#0f4d23;}

/* Hero */
.hero{text-align:center;padding:60px 20px;background:rgba(223,240,216,0.85);border-radius:15px;margin:20px auto;max-width:1200px;}
.hero h2{color:#19692c;font-size:2.5em;margin-bottom:10px;}
.hero p{font-size:1.1em;}

/* Crops Grid */
.crops-container{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:25px;
  max-width:1200px;
  margin:20px auto;
  padding:0 20px;
}
.crop-card{
  background:rgba(255,255,255,0.95);
  padding:20px;
  border-radius:12px;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
  transition:transform 0.3s,box-shadow 0.3s;
  position:relative;
}
.crop-card:hover{transform:translateY(-5px);box-shadow:0 8px 16px rgba(0,0,0,0.2);}
.crop-card img{width:100%;height:160px;border-radius:10px;object-fit:cover;}
.crop-card h3{margin-top:10px;color:#19692c;}
.crop-card p{font-size:0.95em;margin:6px 0;}
.crop-card button{
  margin-top:10px;
  background:#19692c;
  color:white;
  padding:10px 18px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  width:100%;
}
.crop-card button:hover{background:#0f4d23;}
.crop-card .add-cart{background:#27ae60;}
.crop-card .add-cart:hover{background:#1e8449;}

/* Star Rating */
.star-rating{margin:6px 0;}
.star-rating i{color:gold;margin-right:2px;}
.star-rating i.empty{color:#ccc;}

/* Crop Type */
.crop-type{
  position:absolute;
  top:12px;
  left:12px;
  padding:5px 10px;
  border-radius:5px;
  color:white;
  font-size:13px;
  font-weight:bold;
  text-transform:uppercase;
}
.vegetable{background:#27ae60;}
.fruit{background:#e74c3c;}
.cereal{background:#f39c12;}

/* Footer */
footer{
  background-color:#19692c;
  color:white;
  padding:30px 20px;
  font-size:13px;
  line-height:1.4;
  border-radius:10px 10px 0 0;
  margin-top:40px;
}
footer .footer-container{
  display:flex;
  flex-wrap:wrap;
  max-width:1200px;
  margin:0 auto;
  justify-content:space-between;
  gap:15px;
}
.footer-brand,.footer-links,.footer-social{flex:1 1 250px;}
.footer-brand h2{margin-bottom:8px;color:#a8d5a2;font-size:1.2em;}
.footer-links h4,.footer-social h4{margin-bottom:8px;font-size:14px;color:#a8d5a2;}
.footer-links ul{list-style:none;padding:0;}
.footer-links li{margin-bottom:5px;}
.footer-links a,.footer-social a{color:white;text-decoration:none;margin-right:10px;font-weight:bold;font-size:13px;}
.footer-links a:hover,.footer-social a:hover{color:#a8d5a2;}
.footer-social a i{margin-right:5px;}
.footer-bottom{text-align:center;margin-top:15px;border-top:1px solid rgba(255,255,255,0.3);padding-top:8px;}

/* Responsive */
@media(max-width:768px){
  header{flex-direction:column;align-items:flex-start;}
  nav{text-align:left;margin-top:10px;}
  nav a{display:inline-block;margin:5px 8px;font-size:13px;}
  .hero h2{font-size:1.6em;}
  .hero p{font-size:0.95em;}
  .footer-container{flex-direction:column;text-align:center;}
  .footer-social a{display:inline-block;margin:5px;}
}
</style>
</head>
<body>

<header>
  <div class="logo-container">
    <img src="../../images/logo.png" alt="AgriChain Logo">
  </div>
  <nav>
    <a href="../../index.html" data-i18n="nav.home">Home</a>
    <a href="../../All/about.html" data-i18n="nav.about">About</a>
    <a href="../../instruction/farmerinstruction.html" data-i18n="nav.farmer">Farmer</a>
    <a href="../../Dashboard/buyer/buyer_dashboard.html" data-i18n="nav.buyer">Buyer</a>
    <a href="../../instruction/admininstruction.html" data-i18n="nav.admin">Admin</a>
    <a href="../../instruction/trnsportinstruction.html" data-i18n="nav.transporter">Transporter</a>
    <a href="../../instruction/insuranceinstruction.html" data-i18n="nav.insurance">Insurance</a>
  </nav>
  <div class="language-toggle">
    <button onclick="changeLang('en')">English</button>
    <button onclick="changeLang('ta')">தமிழ்</button>
  </div>
</header>

<section class="hero">
  <h2 data-i18n="hero.title">Available Crops</h2>
  <p data-i18n="hero.subtitle">Explore fresh crops from farmers across regions.</p>
</section>

<section class="crops-container" id="cropList"></section>

<footer>
  <div class="footer-container">
    <div class="footer-brand">
      <h2 data-i18n="brand">AgriChain</h2>
      <p data-i18n="footer.text">Empowering agriculture through transparency and direct farmer-buyer connection.</p>
    </div>
    <div class="footer-links">
      <h4>Quick Links</h4>
      <ul>
        <li><a href="../../index.html" data-i18n="nav.home">Home</a></li>
        <li><a href="../../All/about.html" data-i18n="nav.about">About</a></li>
        <li><a href="../../All/contact.html" data-i18n="nav.contact">Contact</a></li>
      </ul>
    </div>
    <div class="footer-social">
      <h4>Follow Us</h4>
      <a href="https://facebook.com" target="_blank"><i class="fab fa-facebook-f"></i> Facebook</a>
      <a href="https://wa.me/+919541954142" target="_blank"><i class="fab fa-whatsapp"></i> WhatsApp</a>
      <a href="https://twitter.com" target="_blank"><i class="fab fa-twitter"></i> Twitter</a>
    </div>
  </div>
  <div class="footer-bottom">
    <p data-i18n="footer.bottom">© 2025 AgriChain. All Rights Reserved.</p>
  </div>
</footer>

<script src="https://unpkg.com/i18next@23.7.6/dist/umd/i18next.min.js"></script>
<script>
// ===== i18n Setup =====
const resources = {
  en:{translation:{
    title:"View Crops - AgriChain",
    brand:"AgriChain",
    nav:{home:"Home",about:"About",farmer:"Farmer",buyer:"Buyer",admin:"Admin",transporter:"Transporter",insurance:"Insurance",contact:"Contact"},
    hero:{title:"Available Crops",subtitle:"Explore fresh crops from farmers across regions."},
    footer:{text:"Empowering agriculture through transparency and direct farmer-buyer connection.",bottom:"© 2025 AgriChain. All Rights Reserved."},
    buttons:{buy:"Buy Now",cart:"Add to Cart"},
    alerts:{added:"Item added to cart!",buy:"You are buying crop ID:"}
  }},
  ta:{translation:{
    title:"பயிர்கள் பார்க்க - அக்ரிச்செயின்",
    brand:"அக்ரிச்செயின்",
    nav:{home:"முகப்பு",about:"பற்றி",farmer:"விவசாயி",buyer:"வாங்குபவர்",admin:"நிர்வாகி",transporter:"போக்குவரத்து",insurance:"காப்பீடு",contact:"தொடர்பு"},
    hero:{title:"கிடைக்கும் பயிர்கள்",subtitle:"பல்வேறு விவசாயிகளிடமிருந்து புதிய பயிர்களை ஆராயுங்கள்."},
    footer:{text:"அக்ரிச்செயின் – விவசாயம் மற்றும் வாங்குபவர்களை நேரடியாக இணைக்கும் நம்பகமான தளம்.",bottom:"© 2025 அக்ரிச்செயின். எல்லா உரிமைகளும் பாதுகாக்கப்பட்டவை."},
    buttons:{buy:"இப்போது வாங்க",cart:"வண்டியில் சேர்"},
    alerts:{added:"பொருள் வண்டியில் சேர்க்கப்பட்டது!",buy:"நீங்கள் வாங்கும் பயிர் ஐடி:"}
  }}
};

i18next.init({lng:"en",debug:false,resources},updateContent);
function updateContent(){
  document.querySelectorAll("[data-i18n]").forEach(el=>{
    const key=el.getAttribute("data-i18n");
    el.innerHTML=i18next.t(key);
    if(el.tagName==="TITLE")el.textContent=i18next.t(key);
  });
}
function changeLang(lang){i18next.changeLanguage(lang,updateContent);localStorage.setItem("lang",lang);}
window.addEventListener("load",()=>{const saved=localStorage.getItem("lang");if(saved)changeLang(saved);});

// ===== Crop Display & Actions =====
function generateStars(rating){
  let stars="";for(let i=1;i<=5;i++){stars+=i<=rating?'<i class="fas fa-star"></i>':'<i class="fas fa-star empty"></i>';}
  return stars;
}

let cart=[];

async function loadCrops(){
  try{
    const res=await fetch("http://localhost:3000/api/crops");
    const crops=await res.json();
    const container=document.getElementById("cropList");
    container.innerHTML="";
    crops.forEach(c=>{
      const card=document.createElement("div");
      card.className="crop-card";
      card.innerHTML=`
        <div class="crop-type ${c.type.toLowerCase()}">${c.type}</div>
        <img src="${c.image}" alt="${c.name}">
        <h3>${c.name}</h3>
        <p>Quantity: ${c.quantity}</p>
        <p>Price: ₹${c.price}</p>
        <p>Farmer: ${c.farmerName}</p>
        <div class="star-rating">${generateStars(c.quality)}</div>
        <button class="add-cart" onclick="addToCart('${c._id}')">${i18next.t('buttons.cart')}</button>
        <button onclick="buyCrop('${c._id}')">${i18next.t('buttons.buy')}</button>
      `;
      container.appendChild(card);
    });
  }catch(err){
    console.error("Error loading crops:",err);
  }
}

function addToCart(cropId){
  if(!cart.includes(cropId)){
    cart.push(cropId);
    alert(i18next.t("alerts.added"));
  }
}

function buyCrop(cropId){
  alert(i18next.t("alerts.buy")+" "+cropId);
  // Future: redirect to order form or payment
}

loadCrops();
</script>
</body>
</html>
