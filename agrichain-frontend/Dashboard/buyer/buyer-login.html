<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AgriChain - Buyer Login</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://unpkg.com/i18next@22.4.9/i18next.min.js"></script>
<script src="https://unpkg.com/i18next-browser-languagedetector@7.2.1/i18nextBrowserLanguageDetector.min.js"></script>

<style>
/* ✅ Your CSS unchanged */
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;}
html, body{height:100%;overflow-x:hidden;scroll-behavior:smooth;}
body{
  background: 
    linear-gradient(rgba(168,224,99,0.5), rgba(86,171,47,0.5)),
    url('../../images/buyer_login.jpg') no-repeat center top;
  background-size: 100% auto;
  background-attachment: scroll;
  display:flex;flex-direction:column;
}
header{
  background: rgba(25,105,44,0.95);
  padding:15px 20px;display:flex;
  justify-content:space-between;align-items:center;color:white;
}
header img{height:60px;border-radius:10px;}
nav a{color:white;margin:0 10px;text-decoration:none;font-weight:bold;}
.language-toggle button{padding:6px 12px;border:none;background:#f5f4f3;border-radius:6px;font-weight:bold;cursor:pointer;}
.title{text-align:center;margin:25px 0;color:#19692c;font-size:2.4rem;}
main{flex:1;display:flex;justify-content:center;align-items:flex-start;padding:20px 0;}
.section{width:90%;max-width:500px;padding:35px;background:#fff;border-radius:20px;box-shadow:0 10px 25px rgba(0,0,0,0.2);}
.section input{width:100%;padding:14px;border:2px solid #000;border-radius:10px;margin-bottom:20px;}
.section button{width:100%;padding:14px;background:#27ae60;border:none;border-radius:10px;color:#fff;font-weight:bold;font-size:18px;}
footer{background:#19692c;color:white;text-align:center;padding:12px;}
</style>
</head>

<body>

<header>
  <img src="../../images/logo.png">
  <nav>
    <a href="../../index.html" data-i18n="nav-home">Home</a>
    <a href="../../All/about.html" data-i18n="nav-about">About</a>
    <a href="../../instruction/farmerinstruction.html" data-i18n="nav-farmer">Farmer</a>
    <a href="../../instruction/buyerinstruction.html" data-i18n="nav-buyer">Buyer</a>
    <a href="../../instruction/admininstruction.html" data-i18n="nav-admin">Admin</a>
    <a href="../../instruction/trnsportinstruction.html" data-i18n="nav-transporter">Transporter</a>
    <a href="../../instruction/insuranceinstruction.html" data-i18n="nav-insurance">Insurance</a>
  </nav>

  <div class="language-toggle">
    <button onclick="changeLng('en')">English</button>
    <button onclick="changeLng('ta')">தமிழ்</button>
  </div>
</header>

<h2 class="title" data-i18n="login-title">HarvestLink</h2>

<main>
  <div class="section">
    <form id="buyerLoginForm">
      <label data-i18n="label-email">Email</label>
      <input type="text" id="email" required>

      <label data-i18n="label-password">Password</label>
      <input type="password" id="password" required>

      <button type="submit" data-i18n="btn-login">Login</button>
    </form>
<br>
    <div class="login-link" style="text-align: center;">
      <span data-i18n="not-registered">New to HarvestLink?</span>
      <a href="../../Dashboard/buyer/buyer-signup.html" data-i18n="signup-link">Signup</a>
    </div>
  </div>
</main>

<footer data-i18n="footer-text">© 2025 AgriChain. All Rights Reserved.</footer>

<script>
/* ✅ Language dictionary */
const resources={
  en:{translation:{
    "nav-home":"Home","nav-about":"About","nav-farmer":"Farmer","nav-buyer":"Buyer","nav-transporter":"Transporter","nav-admin":"Admin","nav-insurance":"Insurance",
    "login-title":"HarvestLink",
    "label-email":"Email","label-password":"Password","btn-login":"Login",
    "not-registered":"New to HarvestLink?","signup-link":"Signup",
    "footer-text":"© 2025 AgriChain. All Rights Reserved."
  }},
  ta:{translation:{
    "nav-home":"முகப்பு","nav-about":"பற்றி","nav-farmer":"விவசாயி","nav-buyer":"வாங்குபவர்","nav-transporter":"போக்குவரத்து","nav-admin":"நிர்வாகி","nav-insurance":"காப்பீடு",
    "login-title":"ஹார்வெஸ்ட் லிங்க்",
    "label-email":"மின்னஞ்சல்","label-password":"கடவுச்சொல்","btn-login":"உள்நுழைவு",
    "not-registered":"புதிய வாங்குபவரா?","signup-link":"பதிவு செய்யவும்",
    "footer-text":"© 2025 அக்ரிச்செயின். அனைத்து உரிமைகளும் பாதுகாக்கப்பட்டவை."
  }}
};

i18next.use(i18nextBrowserLanguageDetector).init({resources,fallbackLng:'en'},updateTexts);

function changeLng(l){i18next.changeLanguage(l,updateTexts);}
function updateTexts(){document.querySelectorAll("[data-i18n]").forEach(el=>{el.innerHTML=i18next.t(el.getAttribute("data-i18n"));});}

/* ✅ REST API Login */
document.getElementById("buyerLoginForm").addEventListener("submit",async(e)=>{
    e.preventDefault();
    const data = {email:email.value,password:password.value};

    let r = await fetch("http://localhost:5000/api/buyer/login",{
      method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)
    });

    let res = await r.json();
    alert(res.message);
    if(res.success){
      localStorage.setItem("buyer_id",res.buyer_id);
      location.href="../../Dashboard/buyer/buyer-dashboard.html";
    }
});
</script>
</body>
</html>
